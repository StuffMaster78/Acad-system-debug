# Generated by Django 5.0.14 on 2025-10-29 09:36

import django.contrib.postgres.fields
import django.utils.timezone
import notifications_system.enums
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='BroadcastAcknowledgement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('event_type', models.CharField(choices=[('orders', 'Orders'), ('payments', 'Payments'), ('writers', 'Writers'), ('clients', 'Clients'), ('security', 'Security'), ('system', 'System'), ('custom', 'Custom')], max_length=100)),
                ('acknowledged_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('via_channel', models.CharField(blank=True, help_text='Channel via which user acknowledged (e.g., in_app, email)', max_length=50, null=True)),
            ],
            options={
                'verbose_name': 'Broadcast Acknowledgement',
                'verbose_name_plural': 'Broadcast Acknowledgements',
                'ordering': ['-acknowledged_at'],
            },
        ),
        migrations.CreateModel(
            name='BroadcastNotification',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=255)),
                ('event_type', models.CharField(choices=[('orders', 'Orders'), ('payments', 'Payments'), ('writers', 'Writers'), ('clients', 'Clients'), ('security', 'Security'), ('system', 'System'), ('custom', 'Custom')], max_length=100)),
                ('message', models.TextField()),
                ('show_to_all', models.BooleanField(default=False)),
                ('target_roles', django.contrib.postgres.fields.ArrayField(base_field=models.CharField(max_length=50), blank=True, default=list, size=None)),
                ('channels', models.JSONField(default=list)),
                ('is_optional', models.BooleanField(default=False, help_text='Respects user preferences if True')),
                ('is_blocking', models.BooleanField(default=True)),
                ('require_acknowledgement', models.BooleanField(default=True)),
                ('pinned', models.BooleanField(default=False)),
                ('dismissible', models.BooleanField(default=True)),
                ('send_email', models.BooleanField(default=False)),
                ('show_in_dashboard', models.BooleanField(default=True)),
                ('scheduled_for', models.DateTimeField(blank=True, null=True)),
                ('sent_at', models.DateTimeField(blank=True, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('expires_at', models.DateTimeField(blank=True, null=True)),
                ('archived_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Broadcast Notification',
                'verbose_name_plural': 'Broadcast Notifications',
                'db_table': 'broadcast_notification',
                'ordering': ['-pinned', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='BroadcastOverride',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('force_channels', django.contrib.postgres.fields.ArrayField(base_field=models.CharField(choices=[('email', 'Email'), ('in_app', 'In-app'), ('sms', 'SMS'), ('ws', 'WebSocket'), ('sse', 'Server-Sent Events'), ('push', 'Push'), ('webhook', 'Webhook'), ('telegram', 'Telegram'), ('discord', 'Discord'), ('system', 'System'), ('whatsapp', 'WhatsApp')], max_length=50), size=None)),
                ('override_config', models.JSONField(blank=True, default=dict, help_text='Custom configuration for this override, e.g. priority, category, message, title')),
                ('is_active', models.BooleanField(default=True)),
                ('event_type', models.CharField(choices=[('orders', 'Orders'), ('payments', 'Payments'), ('writers', 'Writers'), ('clients', 'Clients'), ('security', 'Security'), ('system', 'System'), ('custom', 'Custom')], max_length=100)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Broadcast Override',
                'verbose_name_plural': 'Broadcast Overrides',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ChannelPreference',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('channel', models.CharField(choices=[('email', 'Email'), ('in_app', 'In-app'), ('sms', 'SMS'), ('ws', 'WebSocket'), ('sse', 'Server-Sent Events'), ('push', 'Push'), ('webhook', 'Webhook'), ('telegram', 'Telegram'), ('discord', 'Discord'), ('system', 'System'), ('whatsapp', 'WhatsApp')], max_length=32)),
                ('no_notify', models.BooleanField(default=False)),
                ('digest_only', models.BooleanField(default=False)),
            ],
            options={
                'verbose_name': 'Channel Preference',
                'verbose_name_plural': 'Channel Preferences',
            },
        ),
        migrations.CreateModel(
            name='Delivery',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('event_key', models.CharField(max_length=128)),
                ('channel', models.CharField(choices=[('email', 'Email'), ('in_app', 'In-app'), ('sms', 'SMS'), ('ws', 'WebSocket'), ('sse', 'Server-Sent Events'), ('push', 'Push'), ('webhook', 'Webhook'), ('telegram', 'Telegram'), ('discord', 'Discord'), ('system', 'System'), ('whatsapp', 'WhatsApp')], max_length=16)),
                ('priority', models.CharField(choices=notifications_system.enums.NotificationPriority.choices, max_length=16)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('queued', 'Queued'), ('sent', 'Sent'), ('retry', 'Retry'), ('delayed', 'Delayed'), ('timeout', 'Timeout'), ('failed', 'Failed'), ('dlq', 'Dead Letter Queue'), ('cancelled', 'Cancelled'), ('bounced', 'Bounced'), ('opened', 'Opened'), ('clicked', 'Clicked'), ('undeliverable', 'Undeliverable'), ('complaint', 'Complaint'), ('subscribed', 'Subscribed'), ('unsubscribed', 'Unsubscribed'), ('skipped', 'Skipped')], default='queued', max_length=16)),
                ('attempts', models.PositiveIntegerField(default=0)),
                ('provider', models.CharField(blank=True, max_length=64)),
                ('provider_msg_id', models.CharField(blank=True, max_length=128)),
                ('error_code', models.CharField(blank=True, max_length=64)),
                ('error_detail', models.TextField(blank=True)),
                ('payload', models.JSONField(blank=True, default=dict)),
                ('rendered', models.JSONField(blank=True, default=dict)),
                ('dedupe_key', models.CharField(blank=True, db_index=True, max_length=256)),
                ('queued_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('sent_at', models.DateTimeField(blank=True, null=True)),
                ('read_at', models.DateTimeField(blank=True, null=True)),
            ],
            options={
                'db_table': 'notif_delivery',
            },
        ),
        migrations.CreateModel(
            name='EmailNotificationLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('sent_at', models.DateTimeField(blank=True, null=True)),
                ('subject', models.CharField(max_length=255)),
                ('body', models.TextField()),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('queued', 'Queued'), ('sent', 'Sent'), ('retry', 'Retry'), ('delayed', 'Delayed'), ('timeout', 'Timeout'), ('failed', 'Failed'), ('dlq', 'Dead Letter Queue'), ('cancelled', 'Cancelled'), ('bounced', 'Bounced'), ('opened', 'Opened'), ('clicked', 'Clicked'), ('undeliverable', 'Undeliverable'), ('complaint', 'Complaint'), ('subscribed', 'Subscribed'), ('unsubscribed', 'Unsubscribed'), ('skipped', 'Skipped')], default='pending', help_text='Current delivery status of the email.', max_length=20)),
                ('response_code', models.IntegerField(blank=True, help_text='HTTP response code from the email delivery attempt.', null=True)),
                ('response_message', models.TextField(blank=True, help_text='Response message from the email delivery attempt.', null=True)),
            ],
        ),
        migrations.CreateModel(
            name='EventNotificationPreference',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('event', models.CharField(choices=[('orders', 'Orders'), ('payments', 'Payments'), ('writers', 'Writers'), ('clients', 'Clients'), ('security', 'Security'), ('system', 'System'), ('custom', 'Custom')], max_length=100)),
                ('email_enabled', models.BooleanField(default=True)),
                ('sms_enabled', models.BooleanField(default=False)),
                ('push_enabled', models.BooleanField(default=True)),
                ('in_app_enabled', models.BooleanField(default=True)),
                ('is_read', models.BooleanField(default=False)),
                ('dnd_enabled', models.BooleanField(default=False)),
                ('dnd_start', models.PositiveIntegerField(default=22)),
                ('dnd_end', models.PositiveIntegerField(default=6)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
        ),
        migrations.CreateModel(
            name='GlobalNotificationSystemSettings',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('fallback_rules', models.JSONField(blank=True, default=dict)),
                ('max_retries_per_channel', models.JSONField(blank=True, default=dict)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Global Notification System Settings',
                'verbose_name_plural': 'Global Notification System Settings',
            },
        ),
        migrations.CreateModel(
            name='GroupNotificationProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100)),
                ('role_slug', models.SlugField(blank=True, help_text="Optional slug for the role (e.g., 'writer')", null=True)),
                ('is_default', models.BooleanField(default=False)),
                ('is_active', models.BooleanField(default=True)),
                ('receive_email', models.BooleanField(default=True)),
                ('receive_in_app', models.BooleanField(default=True)),
                ('receive_push', models.BooleanField(default=False)),
                ('receive_sms', models.BooleanField(default=False)),
                ('allowed_channels', models.JSONField(default=list)),
                ('min_priority', models.PositiveSmallIntegerField(default=notifications_system.enums.NotificationPriority['NORMAL'])),
            ],
        ),
        migrations.CreateModel(
            name='Notification',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('type', models.CharField(choices=[('email', 'Email'), ('in_app', 'In-app'), ('sms', 'SMS'), ('ws', 'WebSocket'), ('sse', 'Server-Sent Events'), ('push', 'Push'), ('webhook', 'Webhook'), ('telegram', 'Telegram'), ('discord', 'Discord'), ('system', 'System'), ('whatsapp', 'WhatsApp')], default='in_app', help_text='The type of notification.', max_length=20)),
                ('title', models.CharField(help_text='Notification title.', max_length=255)),
                ('message', models.TextField(help_text='Notification content.')),
                ('link', models.URLField(blank=True, help_text='Link to more information or action.', null=True)),
                ('is_read', models.BooleanField(default=False, help_text='Has the user read this notification?')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('queued', 'Queued'), ('sent', 'Sent'), ('retry', 'Retry'), ('delayed', 'Delayed'), ('timeout', 'Timeout'), ('failed', 'Failed'), ('dlq', 'Dead Letter Queue'), ('cancelled', 'Cancelled'), ('bounced', 'Bounced'), ('opened', 'Opened'), ('clicked', 'Clicked'), ('undeliverable', 'Undeliverable'), ('complaint', 'Complaint'), ('subscribed', 'Subscribed'), ('unsubscribed', 'Unsubscribed'), ('skipped', 'Skipped')], default='pending', help_text='Delivery status of the notification.', max_length=20)),
                ('category', models.CharField(blank=True, choices=[('info', 'Info'), ('warning', 'Warning'), ('error', 'Error'), ('announcement', 'Announcement'), ('news', 'News')], default='info', help_text='Category of the notification.', max_length=20, null=True)),
                ('event', models.CharField(choices=[('orders', 'Orders'), ('payments', 'Payments'), ('writers', 'Writers'), ('clients', 'Clients'), ('security', 'Security'), ('system', 'System'), ('custom', 'Custom')], help_text="Event name, e.g. 'order_assigned'", max_length=100)),
                ('payload', models.JSONField(default=dict, help_text='Structured data for templating')),
                ('template_name', models.CharField(blank=True, max_length=100, null=True)),
                ('is_silent', models.BooleanField(default=False, help_text='Do not deliver to user, only log/store')),
                ('is_critical', models.BooleanField(default=False, help_text='Is this a critical notification that requires immediate attention?')),
                ('is_digest', models.BooleanField(default=False, help_text='Should this be included in digest?')),
                ('digest_group', models.CharField(blank=True, choices=[('daily_summary', 'Daily Summary'), ('weekly_summary', 'Weekly Summary'), ('critical_alerts', 'Critical Alerts')], help_text="Group for digest notifications, e.g. 'daily_summary'", max_length=100, null=True)),
                ('template_version', models.CharField(blank=True, max_length=20, null=True)),
                ('priority', models.IntegerField(default=5, help_text='Higher number = more urgent')),
                ('priority_label', models.CharField(blank=True, help_text="Label for the priority, e.g. 'high', 'medium', 'low'", max_length=50, null=True)),
                ('rendered_title', models.CharField(blank=True, help_text='Rendered title for templating', max_length=255, null=True)),
                ('rendered_message', models.TextField(blank=True, null=True)),
                ('rendered_link', models.URLField(blank=True, null=True)),
                ('rendered_context', models.JSONField(blank=True, default=dict, help_text='Rendered payload for templating', null=True)),
                ('is_broadcast', models.BooleanField(default=False)),
                ('test_mode', models.BooleanField(default=False, help_text='If true, do not deliver for real.')),
                ('is_sent', models.BooleanField(default=False, help_text='Has the notification been sent?')),
                ('channels', django.contrib.postgres.fields.ArrayField(base_field=models.CharField(max_length=50), default=list, help_text="Channels through which the notification was sent, e.g. ['email', 'push']", size=None)),
                ('sent_at', models.DateTimeField(blank=True, help_text='When the notification was sent.', null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('delivered_at', models.DateTimeField(blank=True, help_text='When the notification was delivered.', null=True)),
                ('delivered', models.BooleanField(default=False, help_text='Has the notification been delivered?')),
                ('delivery_status', models.CharField(choices=[('pending', 'Pending'), ('queued', 'Queued'), ('sent', 'Sent'), ('retry', 'Retry'), ('delayed', 'Delayed'), ('timeout', 'Timeout'), ('failed', 'Failed'), ('dlq', 'Dead Letter Queue'), ('cancelled', 'Cancelled'), ('bounced', 'Bounced'), ('opened', 'Opened'), ('clicked', 'Clicked'), ('undeliverable', 'Undeliverable'), ('complaint', 'Complaint'), ('subscribed', 'Subscribed'), ('unsubscribed', 'Unsubscribed'), ('skipped', 'Skipped')], default='pending', help_text='Current delivery status of the notification.', max_length=20)),
                ('delivery_attempts', models.IntegerField(default=0, help_text='Number of attempts made to deliver the notification.')),
                ('retry_count', models.IntegerField(default=0, help_text='Number of retries attempted for this notification.')),
                ('failed_channels', models.JSONField(default=list)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('pinned', models.BooleanField(default=False, help_text='Whether the notification is pinned.')),
                ('expires_at', models.DateTimeField(blank=True, help_text="When the notification expires and shouldn't be shown.", null=True)),
            ],
            options={
                'verbose_name': 'Notification',
                'verbose_name_plural': 'Notifications',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='NotificationDelivery',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('channel', models.CharField(choices=[('email', 'Email'), ('in_app', 'In-app'), ('sms', 'SMS'), ('ws', 'WebSocket'), ('sse', 'Server-Sent Events'), ('push', 'Push'), ('webhook', 'Webhook'), ('telegram', 'Telegram'), ('discord', 'Discord'), ('system', 'System'), ('whatsapp', 'WhatsApp')], max_length=20)),
                ('success', models.BooleanField(default=False, help_text='Was the delivery successful?')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('queued', 'Queued'), ('sent', 'Sent'), ('retry', 'Retry'), ('delayed', 'Delayed'), ('timeout', 'Timeout'), ('failed', 'Failed'), ('dlq', 'Dead Letter Queue'), ('cancelled', 'Cancelled'), ('bounced', 'Bounced'), ('opened', 'Opened'), ('clicked', 'Clicked'), ('undeliverable', 'Undeliverable'), ('complaint', 'Complaint'), ('subscribed', 'Subscribed'), ('unsubscribed', 'Unsubscribed'), ('skipped', 'Skipped')], max_length=20)),
                ('response', models.TextField(blank=True, null=True)),
                ('is_acknowledged', models.BooleanField(default=False)),
                ('acknowledged_at', models.DateTimeField(blank=True, null=True)),
                ('attempts', models.IntegerField(default=0)),
                ('attempted_at', models.DateTimeField(auto_now_add=True)),
                ('triggered_by_fallback', models.BooleanField(default=False)),
                ('sent_at', models.DateTimeField(blank=True, null=True)),
                ('retry_count', models.IntegerField(default=0, help_text='Number of retries attempted for this delivery.')),
                ('error_message', models.TextField(blank=True, null=True)),
            ],
            options={
                'verbose_name': 'Notification Delivery',
                'verbose_name_plural': 'Notification Deliveries',
                'ordering': ['-attempted_at'],
            },
        ),
        migrations.CreateModel(
            name='NotificationDigest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('role', models.CharField(blank=True, choices=[('superadmin', 'Super Admin'), ('admin', 'Admin'), ('editor', 'Editor'), ('support', 'Support'), ('writer', 'Writer'), ('client', 'Client')], help_text='Role of the user for this digest', max_length=50, null=True)),
                ('digest_group', models.CharField(help_text="Group for digest notifications, e.g. 'daily_summary'", max_length=100)),
                ('event', models.CharField(help_text="Event type for the digest, e.g. 'order_updates'", max_length=100)),
                ('category', models.CharField(choices=[('info', 'Info'), ('warning', 'Warning'), ('error', 'Error'), ('announcement', 'Announcement'), ('news', 'News')], default='info', help_text='Category of the notification digest', max_length=50)),
                ('channels', django.contrib.postgres.fields.ArrayField(base_field=models.CharField(choices=[('email', 'Email'), ('in_app', 'In-app'), ('sms', 'SMS'), ('ws', 'WebSocket'), ('sse', 'Server-Sent Events'), ('push', 'Push'), ('webhook', 'Webhook'), ('telegram', 'Telegram'), ('discord', 'Discord'), ('system', 'System'), ('whatsapp', 'WhatsApp')], max_length=50), default=list, help_text='Channels through which the digest will be sent', size=None)),
                ('template_name', models.CharField(blank=True, help_text='Template name for rendering the digest', max_length=100, null=True)),
                ('priority', models.IntegerField(default=5, help_text='Higher number = more urgent')),
                ('priority_label', models.CharField(blank=True, max_length=50, null=True)),
                ('event_key', models.CharField(help_text='Key identifying the type of digest', max_length=100)),
                ('payload', models.JSONField(default=dict, help_text='Payload for the digest')),
                ('scheduled_for', models.DateTimeField(help_text='When the digest is scheduled to be sent')),
                ('is_sent', models.BooleanField(default=False, help_text='Has this digest been sent?')),
                ('is_critical', models.BooleanField(default=False, help_text='Is this a critical digest entry?')),
                ('is_read', models.BooleanField(default=False)),
                ('rendered_title', models.CharField(blank=True, max_length=255, null=True)),
                ('rendered_message', models.TextField(blank=True, null=True)),
                ('rendered_link', models.URLField(blank=True, null=True)),
                ('rendered_context', models.JSONField(blank=True, default=dict, help_text='Rendered payload for templating', null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('sent_at', models.DateTimeField(blank=True, null=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Notification Digest',
                'verbose_name_plural': 'Notification Digests',
                'ordering': ['-scheduled_for'],
                'permissions': [('can_view_notification_digest', 'Can view notification digest'), ('can_send_notification_digest', 'Can send notification digest')],
            },
        ),
        migrations.CreateModel(
            name='NotificationDigestQueue',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('queued', 'Queued'), ('sent', 'Sent'), ('retry', 'Retry'), ('delayed', 'Delayed'), ('timeout', 'Timeout'), ('failed', 'Failed'), ('dlq', 'Dead Letter Queue'), ('cancelled', 'Cancelled'), ('bounced', 'Bounced'), ('opened', 'Opened'), ('clicked', 'Clicked'), ('undeliverable', 'Undeliverable'), ('complaint', 'Complaint'), ('subscribed', 'Subscribed'), ('unsubscribed', 'Unsubscribed'), ('skipped', 'Skipped')], default='pending', help_text='Current status of the digest in the queue.', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('event_key', models.CharField(max_length=255)),
                ('payload', models.JSONField()),
                ('timestamp', models.DateTimeField(default=django.utils.timezone.now)),
            ],
            options={
                'ordering': ['timestamp'],
            },
        ),
        migrations.CreateModel(
            name='NotificationEvent',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('key', models.CharField(max_length=128, unique=True)),
                ('label', models.CharField(max_length=128)),
                ('scope', models.CharField(default='user', max_length=16)),
                ('event', models.CharField(max_length=100, unique=True)),
                ('event_key', models.CharField(help_text="Unique key for the event, e.g. 'order.created'", max_length=100, unique=True)),
                ('name', models.CharField(max_length=150)),
                ('category', models.CharField(blank=True, max_length=100)),
                ('priority', models.CharField(choices=notifications_system.enums.NotificationPriority.choices, default=notifications_system.enums.NotificationPriority['NORMAL'], max_length=16)),
                ('enabled_by_default', models.BooleanField(default=True)),
                ('description', models.TextField(blank=True)),
                ('enabled', models.BooleanField(default=True)),
                ('schema_version', models.PositiveIntegerField(default=1)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('is_active', models.BooleanField(default=True)),
                ('is_critical', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
        ),
        migrations.CreateModel(
            name='NotificationEventConfig',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('event_key', models.CharField(max_length=255, unique=True)),
                ('config_json', models.JSONField()),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Notification Event Config Override',
                'verbose_name_plural': 'Notification Event Config Overrides',
            },
        ),
        migrations.CreateModel(
            name='NotificationEventOverride',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('event_key', models.CharField(db_index=True, help_text='Unique identifier for the event (e.g. user.password_reset_requested).', max_length=128)),
                ('enabled', models.BooleanField(default=True, help_text='Whether this override is active. Overrides default config.')),
                ('priority', models.CharField(blank=True, help_text='Override the priority (e.g. high, medium, low).', max_length=32, null=True)),
                ('channels', django.contrib.postgres.fields.ArrayField(base_field=models.CharField(max_length=32), blank=True, help_text="Override delivery channels (e.g. ['email', 'dashboard']).", null=True, size=None)),
                ('roles', django.contrib.postgres.fields.ArrayField(base_field=models.CharField(max_length=64), blank=True, help_text="Restrict who can receive this notification (e.g. ['client', 'support']).", null=True, size=None)),
                ('fallback_message', models.TextField(blank=True, help_text='Fallback plain text message if no template renders.', null=True)),
                ('template_key', models.CharField(blank=True, help_text='Override the template key for message rendering.', max_length=128, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Notification Event Override',
                'verbose_name_plural': 'Notification Event Overrides',
            },
        ),
        migrations.CreateModel(
            name='NotificationEventPreference',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('receive_email', models.BooleanField(default=True)),
                ('receive_sms', models.BooleanField(default=False)),
                ('receive_push', models.BooleanField(default=False)),
                ('receive_in_app', models.BooleanField(default=True)),
                ('receive_digest', models.BooleanField(default=True)),
            ],
        ),
        migrations.CreateModel(
            name='NotificationGroup',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=50, unique=True)),
                ('description', models.TextField(blank=True)),
                ('channels', models.CharField(help_text="Comma-separated list of channels for this group, e.g. 'email,in_app'", max_length=100)),
                ('is_active', models.BooleanField(default=True, help_text='Is this group active?')),
                ('default_channel', models.CharField(default='in_app', max_length=30)),
                ('default_priority', models.CharField(default='normal', max_length=30)),
                ('is_enabled_by_default', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
        ),
        migrations.CreateModel(
            name='NotificationGroupProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100)),
                ('roles', models.CharField(choices=[('SUPERADMIN', 'superadmin'), ('ADMIN', 'admin'), ('EDITOR', 'editor'), ('SUPPORT', 'support'), ('WRITER', 'writer'), ('CLIENT', 'client')], max_length=50)),
                ('is_active', models.BooleanField(default=True)),
                ('role_slug', models.SlugField(blank=True, help_text="Optional slug for the role (e.g., 'writer')", null=True)),
                ('is_default', models.BooleanField(default=False)),
                ('receive_email', models.BooleanField(default=True)),
                ('receive_in_app', models.BooleanField(default=True)),
                ('receive_push', models.BooleanField(default=False)),
                ('receive_sms', models.BooleanField(default=False)),
                ('allowed_channels', models.JSONField(default=list)),
                ('min_priority', models.PositiveSmallIntegerField(default=notifications_system.enums.NotificationPriority['NORMAL'])),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
        ),
        migrations.CreateModel(
            name='NotificationLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('response_code', models.IntegerField(blank=True, help_text='HTTP response code from the delivery attempt.', null=True)),
                ('response_message', models.TextField(blank=True, help_text='Response message from the delivery attempt.', null=True)),
                ('event', models.CharField(choices=[('orders', 'Orders'), ('payments', 'Payments'), ('writers', 'Writers'), ('clients', 'Clients'), ('security', 'Security'), ('system', 'System'), ('custom', 'Custom')], help_text='Event that triggered this notification.', max_length=100)),
                ('payload', models.JSONField(default=dict, help_text='Payload sent with the notification.')),
                ('delivered', models.BooleanField(default=False)),
                ('delivery_status', models.CharField(choices=[('pending', 'Pending'), ('queued', 'Queued'), ('sent', 'Sent'), ('retry', 'Retry'), ('delayed', 'Delayed'), ('timeout', 'Timeout'), ('failed', 'Failed'), ('dlq', 'Dead Letter Queue'), ('cancelled', 'Cancelled'), ('bounced', 'Bounced'), ('opened', 'Opened'), ('clicked', 'Clicked'), ('undeliverable', 'Undeliverable'), ('complaint', 'Complaint'), ('subscribed', 'Subscribed'), ('unsubscribed', 'Unsubscribed'), ('skipped', 'Skipped')], default='pending', help_text='Current delivery status of the notification.', max_length=20)),
                ('delivery_attempts', models.IntegerField(default=0, help_text='Number of delivery attempts made.')),
                ('priority', models.IntegerField(default=notifications_system.enums.NotificationPriority['NORMAL'], help_text='Priority of the notification, higher number = more urgent')),
                ('channel', models.CharField(choices=[('email', 'Email'), ('in_app', 'In-app'), ('sms', 'SMS'), ('ws', 'WebSocket'), ('sse', 'Server-Sent Events'), ('push', 'Push'), ('webhook', 'Webhook'), ('telegram', 'Telegram'), ('discord', 'Discord'), ('system', 'System'), ('whatsapp', 'WhatsApp')], max_length=20)),
                ('attempted_at', models.DateTimeField(auto_now_add=True)),
                ('success', models.BooleanField(default=False)),
                ('response', models.TextField(blank=True, null=True)),
                ('timestamp', models.DateTimeField(auto_now_add=True)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('queued', 'Queued'), ('sent', 'Sent'), ('retry', 'Retry'), ('delayed', 'Delayed'), ('timeout', 'Timeout'), ('failed', 'Failed'), ('dlq', 'Dead Letter Queue'), ('cancelled', 'Cancelled'), ('bounced', 'Bounced'), ('opened', 'Opened'), ('clicked', 'Clicked'), ('undeliverable', 'Undeliverable'), ('complaint', 'Complaint'), ('subscribed', 'Subscribed'), ('unsubscribed', 'Unsubscribed'), ('skipped', 'Skipped')], default='pending', help_text='Current status of the notification delivery.', max_length=20)),
                ('error', models.TextField(blank=True, help_text='Error message if the delivery failed.', null=True)),
            ],
        ),
        migrations.CreateModel(
            name='NotificationPreference',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('role', models.CharField(blank=True, choices=[('superadmin', 'Super Admin'), ('admin', 'Admin'), ('editor', 'Editor'), ('support', 'Support'), ('writer', 'Writer'), ('client', 'Client')], help_text='The role associated with these preferences, if any.', max_length=50, null=True)),
                ('event', models.CharField(choices=[('orders', 'Orders'), ('payments', 'Payments'), ('writers', 'Writers'), ('clients', 'Clients'), ('security', 'Security'), ('system', 'System'), ('custom', 'Custom')], max_length=100, verbose_name='Event Type')),
                ('event_key', models.CharField(help_text='A unique key for the event, used for overrides and custom handling.', max_length=100)),
                ('channel', models.CharField(choices=[('email', 'Email'), ('in_app', 'In-app'), ('sms', 'SMS'), ('ws', 'WebSocket'), ('sse', 'Server-Sent Events'), ('push', 'Push'), ('webhook', 'Webhook'), ('telegram', 'Telegram'), ('discord', 'Discord'), ('system', 'System'), ('whatsapp', 'WhatsApp')], max_length=20, verbose_name='Notification Channel')),
                ('enabled', models.BooleanField(default=True, help_text='Are notifications enabled for this user?')),
                ('email_enabled', models.BooleanField(default=True)),
                ('sms_enabled', models.BooleanField(default=False)),
                ('push_enabled', models.BooleanField(default=False)),
                ('in_app_enabled', models.BooleanField(default=True)),
                ('digest_enabled', models.BooleanField(default=False)),
                ('digest_type', models.CharField(choices=[('daily_summary', 'Daily Summary'), ('weekly_summary', 'Weekly Summary'), ('critical_alerts', 'Critical Alerts')], default='daily', help_text='Type of digest for notifications.', max_length=20)),
                ('overrides', models.JSONField(default=dict)),
                ('frequency', models.CharField(choices=[('immediate', 'Immediate'), ('daily', 'Daily'), ('weekly', 'Weekly')], default='immediate', help_text='Frequency of notifications.', max_length=20)),
                ('do_not_disturb_start', models.TimeField(blank=True, null=True)),
                ('do_not_disturb_end', models.TimeField(blank=True, null=True)),
                ('do_not_disturb_enabled', models.BooleanField(default=False, help_text='Enable do-not-disturb hours for this user.')),
                ('do_not_disturb_until', models.TimeField(blank=True, help_text='Time until which notifications are muted.', null=True)),
                ('muted_events', models.JSONField(blank=True, default=list)),
                ('mute_all', models.BooleanField(default=False, help_text='Mute all notifications. example: during maintenance or downtime.')),
                ('mute_until', models.DateTimeField(blank=True, help_text='Mute notifications until this datetime.', null=True)),
                ('digest_only', models.BooleanField(default=False, help_text='Only receive notifications in digest form.')),
                ('fall_back_to_digest', models.BooleanField(default=False, help_text='If enabled, notifications will fall back to digest if the user is not online.')),
                ('preferred_channels', models.JSONField(blank=True, default=dict, help_text="Preferences for each channel, e.g. {'email': True, 'sms': False}")),
                ('receive_email', models.BooleanField(default=True)),
                ('receive_in_app', models.BooleanField(default=True)),
                ('receive_push', models.BooleanField(default=False)),
                ('receive_sms', models.BooleanField(default=False)),
                ('allowed_channels', models.JSONField(default=list)),
                ('min_priority', models.PositiveSmallIntegerField(default=notifications_system.enums.NotificationPriority['NORMAL'])),
                ('max_priority', models.PositiveSmallIntegerField(default=notifications_system.enums.NotificationPriority['HIGH'], help_text='Maximum priority level for notifications.')),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Notification Preference',
                'verbose_name_plural': 'Notification Preferences',
            },
        ),
        migrations.CreateModel(
            name='NotificationPreferenceGroup',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, unique=True)),
                ('description', models.TextField(blank=True)),
                ('default_channels', django.contrib.postgres.fields.ArrayField(base_field=models.CharField(choices=[('email', 'Email'), ('in_app', 'In-app'), ('sms', 'SMS'), ('ws', 'WebSocket'), ('sse', 'Server-Sent Events'), ('push', 'Push'), ('webhook', 'Webhook'), ('telegram', 'Telegram'), ('discord', 'Discord'), ('system', 'System'), ('whatsapp', 'WhatsApp')], max_length=20), default=list, size=None)),
                ('quiet_hours', models.JSONField(blank=True, default=dict)),
                ('is_active', models.BooleanField(default=True)),
            ],
        ),
        migrations.CreateModel(
            name='NotificationPreferenceProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, unique=True)),
                ('description', models.TextField(blank=True)),
                ('default_email', models.BooleanField(default=True)),
                ('default_sms', models.BooleanField(default=False)),
                ('default_push', models.BooleanField(default=False)),
                ('default_in_app', models.BooleanField(default=True)),
                ('email_enabled', models.BooleanField(default=True)),
                ('sms_enabled', models.BooleanField(default=False)),
                ('push_enabled', models.BooleanField(default=False)),
                ('in_app_enabled', models.BooleanField(default=True)),
                ('dnd_enabled', models.BooleanField(default=False)),
                ('dnd_start_hour', models.PositiveSmallIntegerField(default=0)),
                ('dnd_end_hour', models.PositiveSmallIntegerField(default=0)),
                ('is_default', models.BooleanField(default=False)),
            ],
            options={
                'verbose_name': 'Notification Preference Profile',
                'verbose_name_plural': 'Notification Preference Profiles',
            },
        ),
        migrations.CreateModel(
            name='NotificationProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(default='Custom', max_length=64, unique=True)),
                ('description', models.TextField(blank=True)),
                ('default_email', models.BooleanField(default=True)),
                ('default_sms', models.BooleanField(default=False)),
                ('default_push', models.BooleanField(default=False)),
                ('default_in_app', models.BooleanField(default=True)),
                ('dnd_start', models.TimeField(blank=True, null=True)),
                ('dnd_end', models.TimeField(blank=True, null=True)),
                ('dnd_channels', django.contrib.postgres.fields.ArrayField(base_field=models.CharField(max_length=20), blank=True, default=list, size=None)),
                ('fallback_rules', models.JSONField(blank=True, default=dict)),
                ('max_retries_per_channel', models.JSONField(blank=True, default=dict)),
                ('is_active', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Notification Profile',
                'verbose_name_plural': 'Notification Profiles',
            },
        ),
        migrations.CreateModel(
            name='NotificationsUserStatus',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('is_acknowledged', models.BooleanField(default=False)),
                ('is_acknowledged_at', models.DateTimeField(blank=True, null=True)),
                ('is_read', models.BooleanField(default=False)),
                ('read_at', models.DateTimeField(blank=True, null=True)),
                ('pinned', models.BooleanField(default=False)),
                ('pinned_at', models.DateTimeField(blank=True, null=True)),
                ('priority', models.CharField(choices=[(1, 'Emergency'), (2, 'High'), (3, 'Medium High'), (5, 'Normal'), (7, 'Low'), (10, 'Passive')], default=notifications_system.enums.NotificationPriority['NORMAL'], max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'User Notification Status',
                'verbose_name_plural': 'User Notification Statuses',
            },
        ),
        migrations.CreateModel(
            name='NotificationTemplate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('channel', models.CharField(choices=[('email', 'Email'), ('in_app', 'In-app'), ('sms', 'SMS'), ('ws', 'WebSocket'), ('sse', 'Server-Sent Events'), ('push', 'Push'), ('webhook', 'Webhook'), ('telegram', 'Telegram'), ('discord', 'Discord'), ('system', 'System'), ('whatsapp', 'WhatsApp')], max_length=16)),
                ('locale', models.CharField(default='en', max_length=10)),
                ('version', models.PositiveIntegerField(default=1)),
                ('subject', models.CharField(blank=True, max_length=200)),
                ('body_html', models.TextField(blank=True)),
                ('body_text', models.TextField(blank=True)),
                ('provider_overrides', models.JSONField(blank=True, default=dict)),
            ],
            options={
                'db_table': 'notif_template',
            },
        ),
        migrations.CreateModel(
            name='Outbox',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('event_key', models.CharField(max_length=128)),
                ('payload', models.JSONField(blank=True, default=dict)),
                ('dedupe_key', models.CharField(blank=True, db_index=True, max_length=256)),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('processed_at', models.DateTimeField(blank=True, null=True)),
                ('attempts', models.PositiveIntegerField(default=0)),
                ('last_error', models.TextField(blank=True)),
            ],
            options={
                'db_table': 'notif_outbox',
            },
        ),
        migrations.CreateModel(
            name='RoleNotificationPreference',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('role', models.CharField(blank=True, choices=[('superadmin', 'Super Admin'), ('admin', 'Admin'), ('editor', 'Editor'), ('support', 'Support'), ('writer', 'Writer'), ('client', 'Client')], help_text='The role associated with these preferences, if any.', max_length=50, null=True)),
                ('default_channels', models.JSONField(default=list)),
                ('min_priority', models.PositiveSmallIntegerField(default=notifications_system.enums.NotificationPriority['NORMAL'])),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
        ),
        migrations.CreateModel(
            name='TemplatePerformance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('event_key', models.CharField(db_index=True, max_length=100)),
                ('template_type', models.CharField(max_length=20)),
                ('channel', models.CharField(max_length=20)),
                ('website_id', models.IntegerField(blank=True, null=True)),
                ('date', models.DateField(db_index=True)),
                ('hour', models.PositiveSmallIntegerField(default=0)),
                ('render_count', models.PositiveIntegerField(default=0)),
                ('success_count', models.PositiveIntegerField(default=0)),
                ('error_count', models.PositiveIntegerField(default=0)),
                ('avg_render_time', models.FloatField(default=0.0)),
                ('min_render_time', models.FloatField(default=0.0)),
                ('max_render_time', models.FloatField(default=0.0)),
                ('click_count', models.PositiveIntegerField(default=0)),
                ('open_count', models.PositiveIntegerField(default=0)),
                ('conversion_count', models.PositiveIntegerField(default=0)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
        ),
        migrations.CreateModel(
            name='TemplateUsage',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('event_key', models.CharField(db_index=True, max_length=100)),
                ('template_type', models.CharField(choices=[('class_based', 'Class Based'), ('database', 'Database'), ('generic', 'Generic'), ('emergency', 'Emergency')], max_length=20)),
                ('template_version', models.CharField(default='v1.0', max_length=20)),
                ('channel', models.CharField(db_index=True, max_length=20)),
                ('website_id', models.IntegerField(blank=True, db_index=True, null=True)),
                ('locale', models.CharField(default='en', max_length=10)),
                ('render_count', models.PositiveIntegerField(default=0)),
                ('success_count', models.PositiveIntegerField(default=0)),
                ('error_count', models.PositiveIntegerField(default=0)),
                ('total_render_time', models.FloatField(default=0.0)),
                ('avg_render_time', models.FloatField(default=0.0)),
                ('click_count', models.PositiveIntegerField(default=0)),
                ('open_count', models.PositiveIntegerField(default=0)),
                ('conversion_count', models.PositiveIntegerField(default=0)),
                ('first_used', models.DateTimeField(auto_now_add=True)),
                ('last_used', models.DateTimeField(auto_now=True)),
            ],
        ),
        migrations.CreateModel(
            name='UserNotificationMeta',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('last_seen_at', models.DateTimeField(default=django.utils.timezone.now)),
            ],
            options={
                'verbose_name': 'User Notification Meta',
                'verbose_name_plural': 'User Notification Metas',
                'db_table': 'user_notification_meta',
            },
        ),
        migrations.CreateModel(
            name='UserNotificationPreference',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('channel', models.CharField(choices=[('email', 'Email'), ('in_app', 'In-app'), ('sms', 'SMS'), ('ws', 'WebSocket'), ('sse', 'Server-Sent Events'), ('push', 'Push'), ('webhook', 'Webhook'), ('telegram', 'Telegram'), ('discord', 'Discord'), ('system', 'System'), ('whatsapp', 'WhatsApp')], max_length=20, verbose_name='Notification Channel of Preference')),
                ('enabled', models.BooleanField(default=True)),
                ('quiet_hours', models.JSONField(blank=True, default=dict)),
                ('mute_until', models.DateTimeField(blank=True, null=True)),
            ],
            options={
                'verbose_name': 'User Notification Preference',
                'verbose_name_plural': 'User Notification Preferences',
            },
        ),
        migrations.CreateModel(
            name='UserNotificationSettings',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('do_not_disturb_start', models.TimeField(blank=True, null=True)),
                ('do_not_disturb_end', models.TimeField(blank=True, null=True)),
                ('do_not_disturb_enabled', models.BooleanField(default=False)),
                ('do_not_disturb_until', models.TimeField(blank=True, null=True)),
                ('mute_all', models.BooleanField(default=False)),
                ('mute_until', models.DateTimeField(blank=True, null=True)),
                ('muted_events', models.JSONField(blank=True, default=list)),
                ('digest_enabled', models.BooleanField(default=False)),
                ('digest_only', models.BooleanField(default=False)),
                ('fall_back_to_digest', models.BooleanField(default=False)),
                ('digest_type', models.CharField(choices=[('daily', 'Daily'), ('weekly', 'Weekly')], default='daily', max_length=20)),
                ('digest_time', models.TimeField(blank=True, null=True)),
                ('digest_days', models.JSONField(blank=True, default=list)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'User Notification Settings',
                'verbose_name_plural': 'User Notification Settings',
            },
        ),
    ]
