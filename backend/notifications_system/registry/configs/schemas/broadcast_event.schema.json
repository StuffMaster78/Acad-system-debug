{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Broadcast Events (Array Root)",
  "type": "array",
  "items": {
    "type": "object",
    "required": ["event_key", "description", "scope", "channels"],
    "properties": {
      "event_key": {
        "type": "string",
        "pattern": "^[a-z0-9]+(\\.[a-z0-9_]+)+$",
        "description": "Unique dotted key, e.g. broadcast.system_announcement"
      },
      "description": {
        "type": "string",
        "minLength": 3
      },
      "scope": {
        "type": "string",
        "enum": ["systemwide", "website"],
        "default": "systemwide"
      },
      "priority": {
        "type": "string",
        "enum": ["low", "normal", "medium", "high", "critical"],
        "default": "normal"
      },
      "channels": {
        "type": "array",
        "items": {
          "type": "string",
          "enum": [
            "email","sms","in_app","push","webhook",
            "telegram","whatsapp","sse","ws","slack","discord"
          ]
        },
        "minItems": 1,
        "uniqueItems": true
      },
      "forced_channels": {
        "type": "array",
        "items": {
          "type": "string",
          "enum": [
            "email","sms","in_app","push","webhook",
            "telegram","whatsapp","sse","ws","slack","discord"
          ]
        },
        "uniqueItems": true
      },
      "filters": {
        "type": "object",
        "properties": {
          "roles": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": ["client","writer","admin","support","super_admin","editor", "user"]
            },
            "uniqueItems": true
          },
          "is_active": { "type": "boolean" },
          "custom_conditions": {
            "type": "object",
            "additionalProperties": true
          }
        },
        "additionalProperties": false
      },
      "force_send": {
        "type": "boolean",
        "default": false
      },
      "templates": {
        "type": "object",
        "properties": {
          "email": { "type": "string" },
          "in_app": { "type": "string" },
          "sms": { "type": "string" },
          "push": { "type": "string" },
          "webhook": { "type": "string" },
          "telegram": { "type": "string" },
          "whatsapp": { "type": "string" },
          "slack": { "type": "string" },
          "discord": { "type": "string" }
        },
        "additionalProperties": false
      }
    },
    "additionalProperties": false
  }
}

